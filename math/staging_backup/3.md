## Motivation  
We seek to precondition stochastic gradients by their true Hessian \(H = G\,G^{\!\top}\) so that the “whitened” update  
$$\begin{aligned}
Q = H^{-\tfrac12}\,G
\end{aligned}$$  
is perfectly rotation-preserving.  Since \(H\) is intractable, we introduced the **Muon** estimator  
$$\begin{aligned}
\mathrm{Muon}_k = \mathrm{Ortho}\!\Bigl(\tfrac1k\sum_{i=1}^k g_i\Bigr)
\end{aligned}$$  
and analyzed its bias, then devised schemes to make it consistent and reduce variance.

---

**Claim 1: Whitened gradient equals the polar factor**  
> If \(G = U\,\Sigma\,V^{\!\top}\) is the SVD of the true gradient and \(H = G\,G^{\!\top}\), then  
> \(H^{-\tfrac12}\,G = U\,V^{\!\top} = \mathrm{Ortho}(G).\)

**Justification:**  
$$\begin{aligned}
H^{-\tfrac12}\,G
&= (G\,G^{\!\top})^{-\tfrac12}\,G \\
&= \bigl(U\,\Sigma\,\Sigma\,U^{\!\top}\bigr)^{-\tfrac12}\,(U\,\Sigma\,V^{\!\top}) \\
&= U\,\Sigma^{-1}\,U^{\!\top}\,U\,\Sigma\,V^{\!\top} \\
&= U\,V^{\!\top}.
\end{aligned}$$

---

**Claim 2: Muon’s bias decays as \(O(1/k)\)**  
> Write \(\bar g_k = G + E\) with \(\mathbb{E}[E] = 0\) and \(\mathrm{Cov}(E) = \tfrac1k\,\Sigma\).  Then  
> \(\displaystyle \mathbb{E}\bigl[\mathrm{Ortho}(G+E)\bigr] - \mathrm{Ortho}(G) = O\!\bigl(\tfrac1k\bigr).\)

**Justification:**  
$$\begin{aligned}
\mathrm{Ortho}(G+E)
&= (G+E)\,\bigl[(G+E)^{\!\top}(G+E)\bigr]^{-\tfrac12},\\
(G+E)^{\!\top}(G+E)
&= M + \Delta,\quad M=G^{\!\top}G,\quad \Delta=G^{\!\top}E + E^{\!\top}G + E^{\!\top}E,\\
(M+\Delta)^{-\tfrac12}
&= M^{-\tfrac12}
  -\tfrac12\,M^{-\tfrac32}\,\Delta
  + O(\|\Delta\|^2).\\
\Rightarrow\;\mathrm{Ortho}(G+E)
&= G\,M^{-\tfrac12}
  + E\,M^{-\tfrac12}
  -\tfrac12\,G\,M^{-\tfrac32}(G^{\!\top}E + E^{\!\top}G)
  + O(\|E\|^2).\\
\mathbb{E}[E\,M^{-\tfrac12}] &= 0,\quad \mathbb{E}[G^{\!\top}E] = 0,\\
\mathbb{E}[E^{\!\top}E] &= \tfrac1k\,\Sigma,
\end{aligned}$$  
so the only surviving correction is proportional to \(1/k\), giving \(O(1/k)\) bias.

---

**Claim 3: Muon under-rotates more along noisy directions**  
> The bias matrix  
> \(\displaystyle B = \mathbb{E}[\mathrm{Ortho}(G+E)] - Q
= -\,\tfrac1{2k}\;Q\,M^{-1}\,\Sigma + O(k^{-2})\)  
> shrinks each singular component \(j\) by the factor  
> \(1 - \tfrac{\lambda_j}{2k\,\sigma_j^2}\), where \(\lambda_j\) is the \(j\)th eigenvalue of \(\Sigma\) in the basis diagonalizing \(M\).

**Justification:**  
$$\begin{aligned}
M^{-1}\,\Sigma
&= V\,\mathrm{diag}\!\Bigl(\tfrac{\lambda_j}{\sigma_j^2}\Bigr)\,V^{\!\top},\\
Q_{\rm est}
&= U\,\mathrm{diag}\!\Bigl(1 - \tfrac{\lambda_j}{2k\,\sigma_j^2}\Bigr)\,V^{\!\top}
  + O(k^{-2}),
\end{aligned}$$  
so directions where noise \(\lambda_j\) is large relative to signal \(\sigma_j^2\) are contracted more.

---

**Claim 4: Richardson–Muon cancels the \(O(1/k)\) bias**  
> If \(Q_k\) has bias \(C/k + O(k^{-2})\) and \(Q_{2k}\) has bias \(C/(2k) + O(k^{-2})\), then  
> \(\;2\,Q_{2k} - Q_k = Q + O(k^{-2}).\)

**Justification:**  
$$\begin{aligned}
\mathbb{E}[Q_k] &= Q + \tfrac{C}{k} + O(k^{-2}),\\
\mathbb{E}[Q_{2k}] &= Q + \tfrac{C}{2k} + O(k^{-2}),\\
2\,\mathbb{E}[Q_{2k}] - \mathbb{E}[Q_k]
&= 2\Bigl(Q + \tfrac{C}{2k}\Bigr)
 - \Bigl(Q + \tfrac{C}{k}\Bigr)
= Q + O(k^{-2}).
\end{aligned}$$

---

**Claim 5: Fixed–\(\gamma\) momentum breaks consistency**  
> Using \(m_k = \sum_{i=0}^{k-1}\gamma^i\,g_{t-i}\) gives  
> \(\mathrm{Cov}(m_k - G)\to\Sigma/(1-\gamma^2)\), so the bias does not vanish as \(k\to\infty\).

**Justification:**  
$$\begin{aligned}
\mathrm{Cov}(E_k)
&= \frac1{\bigl(\sum\gamma^i\bigr)^2}
  \sum_{i=0}^{k-1}\gamma^{2i}\,\Sigma
\;\xrightarrow[k\to\infty]{}\;
\frac{\Sigma}{1-\gamma^2},\\
\mathbb{E}[\mathrm{Ortho}(G+E_k)]
&= Q
  -\tfrac12\,Q\,M^{-\tfrac32}\,\mathrm{Cov}(E_k)
  + O\bigl(\|\mathrm{Cov}(E_k)\|^2\bigr),
\end{aligned}$$  
so a nonzero residual bias remains.

---

**Claim 6: Decaying momentum yields a consistent Muon**  
> With \(\beta_t = \tfrac{t-1}{t}\), \(\alpha_t = 1/t\), one has  
> \(m_t = \tfrac1t\sum_{i=1}^t g_i\) and \(\mathrm{Cov}(m_t - G) = \tfrac1t\,\Sigma\), hence  
> \(\mathbb{E}[\mathrm{Ortho}(m_t)] - Q = O(1/t)\to0.\)

**Justification:**  
$$\begin{aligned}
m_t &= \beta_t\,m_{t-1} + \alpha_t\,g_t
     = \tfrac{t-1}t\,\tfrac1{t-1}\sum_{i=1}^{t-1}g_i
     + \tfrac1t\,g_t
     = \tfrac1t\sum_{i=1}^t g_i,\\
\mathrm{Cov}(m_t - G)
&= \tfrac1{t^2}\sum_{i=1}^t \mathrm{Cov}(g_i - G)
= \tfrac1{t}\,\Sigma,\\
\mathbb{E}[\mathrm{Ortho}(m_t)] - Q
&= O\!\bigl(\tfrac1t\bigr)
\;\xrightarrow[t\to\infty]{}\;0.
\end{aligned}$$

*All claims above are fully justified.*
